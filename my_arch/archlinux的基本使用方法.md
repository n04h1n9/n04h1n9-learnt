# archlinux的基本使用方法

archwiki的安装教程有这么一句话：不建议初学者用 archinstall 走捷径，因为手动安装 Arch Linux 本身就是 Arch Linux 教学实操中重要的一环，少了这个环节，会让初学者面对一些基础问题时束手无策，为自己和社区带来不必要的麻烦。但我们作为什么都不懂的新手，我们最起码得先用上arch,才考虑其他事情罢，所以我个人不反对新人通过archinstall逃课（我第一次手动安装失败后就破防用archinstall了），但这样逃课会丢掉很多有关知识，本文的目的就是把这些知识补上，让新手不至于束手无策，也不至于麻烦他人和社区

## 基本使用方法

新手用archinstall时，桌面环境建议且只建议用kde,最还原win体验，功能也最丰富，配置也简单，以下教程均默认你用kde

- 安装软件

与win不同，arch上安装软件是用一个叫pacman的包管理器从arch的仓库上下载的，仓库有什么就能下什么，但别觉得自己被限制，你也可以手动添加其他用户和组织的仓库，比如在安装教程里提到的cn源就是一个对国内用户来说十分强大的仓库。arch还有一个极其强大的社区，aur就是其产物，它的全称叫Arch User Repository（arch用户仓库），顾名思义，任何人都可以把自己的项目上传到aur,也有相当多的开发者愿意把自己的项目上传到aur,这使得arch用户可用的软件包达到一个空前的规模，所以完全不用担心自己软件包不够用，要用aur,最方便的策略是，下载一个aur助手帮助我们管理aur的软件包，在安装教程已经安装了paru了。以下是pacman和paru的常用命令（paru的命令跟pacman大同小异，以下均用pacman演示，除个别paru特殊命令单独列出）：
```
sudo pacman -S [软件包] #安装软件包
sudo pacman -Rns [软件包] #干净卸载软件包
sudo pacman -Ss [软件包] #查找自己的添加的软件库有无指定软件包
pacman -Qs [软件包] #查找自己是否安装了某软件包（这个命令不用sudo）
sudo pacman -Syu #全局系统更新，俗称“滚系统”，每过个几天就要滚一次，区别于win每次更新都要大费周章等个十几甚至几十分钟，arch只需要一分钟不到就能完成更新，而且更新带来的是正反馈
paru [软件包] #查找aur上的软件包，选择对应的序号即可下载
paru #更新aur上的包，相当于paru -Syu
```

> warning:关于aur,有些需要注意的点

1. 由于aur谁都可以上传软件包，所以难免会有一些恶意软件包，在安装aur的软件包时，一定要知道自己在干什么，最好去对应项目的github页面看一下

1. aur的大部分项目要去github把源码拉下来构建软件包，所以要梯子，至于梯子相关的内容，下面会讲

- 命令行相关

 如果你是用一些致力于用户友好的linux发行版，如linux mint这类的，你可以完全不用终端。但这里是arch,终端是你在使用系统的过程中必不可少的部分。使用终端的过程就是你与shell（直译为外壳，但这是一个套在系统内核上的“外壳”，用于处理用户与内核的交互）交互的过程，你可以换用一个更好用的shell来让你更好的使用命令行，这里推荐fish,之前在安装教程里装了，它有自带的语法高亮和自动补全，还支持快速提示符美化，用`chsh -s /usr/bin/fish`更改默认shell,但按照wiki的说法，更改默认shell要对很多文件进行修改，详细内容我目前也不是很懂，请参见[archwiki相关内容](https://wiki.archlinuxcn.org/wiki/Fish#),下面我会基于fish，讲一下命令行常用操作：

```
ls [文件目录] #展示所选文件目录有什么文件，如果什么都不输的话，则展示当前目录
cd [文件目录] #进入某目录，如果什么都不输的话，则回到家目录
mkdir [文件目录] #创建一个目录
rm [文件或文件目录] #删除某文件或目录
cat [文本文件] #把文件的文本打印在终端
echo “指定内容” #在终端打印指定内容，类似于python中的print
su #切换到root用户
#shell脚本&命令行工具相关
fastfetch #打印系统信息在终端
vim [文件名及其目录] #用vim文本编辑器编辑文件
```

掌握这么多也差不多了，等我记得多一点先（

- 快照相关

你都用archlinux了,不折腾一下对不起自己辛苦折腾安装的日子。但乱折腾有可能搞坏系统，也会污染你的系统（你不记得你下载过什么，也不记得你在什么地方写过什么了，你想恢复之前的状态恢复不了），这是我们就要进行快照，相当于玩游戏的回档操作，以下是回档相关操作：

```
sudo snapper -c home create-config /home #在家目录启用快照功能
sudo snapper -c root create-config / #在根目录启用快照功能
sudo snapper -c home create --description "快照描述，不想填可以连同前面的--description一起省略" #创建快照，引号要打
sudo snapper -c home list #展示快照列表，找到你要回档的快照
<<<<<<< HEAD
sudo snapper -c home undochange 0..1 #0是当前状态序号，1是要回档的快照序号，按需改成其他数字，执行了这步就可以回档了
=======
sudo snapper -c home undochange 1..0 #0是当前状态序号，1是要回档的快照序号，按需改成其他数字，执行了这步就可以回档了
>>>>>>> ca34e6fbb0a1ee67151b73002847d7f398a06606
```

tip:有些安装的软件是全局的（不是下载在你的家目录而是下载在系统的根目录），你回档家目录并不能达到卸载软件的效果，应该把家目录和根目录都进行回档，至于家目录和根目录是什么，在后面会讲

更多信息参见[archwiki](https://wiki.archlinuxcn.org/wiki/%E9%A6%96%E9%A1%B5)

## 基础知识科普

- 文件系统 

所谓文件系统，就是数据在计算机中存储的方式，更严格的定义如下：

  - 在计算机体系中，文件系统负责控制如何存放和读取数据。如果没有文件系统，存储介质中的数据就会完全混在一起，无法进行区分。通过把数据分块和命名，不同的信息就可以被隔离和区分。将各组数据命名为“文件”是取自纸质信息系统的命名方式，而“文件系统”是指用于管理信息的分组和命名的结构和逻辑规则

在win上，硬盘被分为C盘、D盘等盘符，这是win管理数据的方式，也就是win的文件系统。linux有一套与win完全不同的文件系统，其最最显著的两个特点是：

1. 一切皆文件。这是linux的设计理念之一，在linux的世界中，无论是你的小作文、软件包，还是你的系统内核及其相关组件，甚至是你的硬件，在linux系统上都能找到对应的文件。

2. linux的文件不像win那样分盘符，而是呈一个树状。树的主干被叫做根目录(/)，其他任何文件夹都在根目录下，包括存放系统内核的boot文件夹，root用户的root文件夹（/root目录，是根目录的子目录），用于挂载磁盘的/mnt目录和/run目录，以及存放非root用户的/home目录，也叫家目录。在这台电脑上的每一个用户都有属于自己在家目录的子目录，就比如说我的用户名叫n04h1n9,那我的家目录就是/home/n04h1n9,我们在系统上大部分活动，包括下载软件，玩游戏，写代码都是在我们自己的家目录完成的。我们不需要像win一样有意不把东西放C盘，有什么东西全往家目录丢就完事了，反正跟系统运行的重要数据基本不再家目录，在家目录的东西只要不是什么都不知道的情况下乱搞，就不会出什么事。顺带一提，有些不可变发行版不可以修改家目录以外的目录，当然arch不是不可变发行版

- 图形界面相关

  - 不像win一样只能用一种图形界面，在linux上你可以更换桌面环境(desktop environment,简称de)，甚至还可以安装多个桌面环境，想用哪个用哪个，最常用的桌面环境是gnome和kde,我个人更推荐用kde,集成程度更高，更开箱即用，但是kde的缺点也很明显：设置界面太多太复杂，跟飞机控制台一样，但如果把它看懂也不是很难，就是得花点时间，弄好后使用体验绝对远超win,但本人好一段时间不用kde了，也没有相关配置给大家抄作业

  - 另一种能提供图形界面的工具是窗口管理器（window manager,简称wm.其实窗口管理器是桌面环境的子集），大部分的窗口管理器（特指需要自己配置的）都是平铺式的，而不是堆叠式的（win,kde,gnome默认都是堆叠式的），平铺式也有不同的布局，在有快照的情况下，你可以把各个窗口管理器和桌面环境挨个试一遍，完了还能独善其身。在窗口管理器中，像任务栏，终端，应用启动器,主题什么的都要自己找，自己配,因此窗口管理器一般都很轻量，但同时也很难配置,但你配完一次后可以复制你的组件和配置文件到一个安全的地方，比如上传到github，从而达到一劳永逸的效果，当然如果你不想配也可以从别人的配置中找一个顺眼的用。或者使用基于quickshell的工具实现快速配置（我就是用的一个叫noctalia的工具）,当然用qiuckshell也可以复制配置文件。我的niri配置文件在[这里](dotfile/niri),复制到~/.config就彳亍了（~/是你的家目录，文件名前面带.的文件是隐藏文件）
  - 显示管理器（display manager,简称dm),是开机完了显示欢迎界面，让你输密码的界面。没错，这个也是可以选的，如果在安装教程那里是照搬我的配置的话，会发现我用的显示管理器是ly,一个tui风格的显示管理器。成熟的桌面环境，像gnome和kde，都有自己的显示管理器。
  - 显示协议
  当前最常见的显示协议就俩：xorg(也叫x11)和wayland。其中x11已经行将就木，而且安全性也不如wayland,因为wayland不允许应用监听键盘输入，而x11反之（大抵是这个意思罢，我也不是特别懂）。与前面几个可以自由排列组合不同，特定的dm,wm,de是与特定的显示协议绑定的，像我用的niri就是wayland的合成器。

> 顺带一提，wayland的键盘布局是用的x11的东西

先写着这些先罢，也不知道要写什么了，欢迎补充，更多linux相关的知识可以阅读[unix大学教程](my_arch/somethingineed/Unix%20Linux大学教程【无封面】)，一本老书，有些地方有点过时,不过大部分内容还是正确且丰富的
